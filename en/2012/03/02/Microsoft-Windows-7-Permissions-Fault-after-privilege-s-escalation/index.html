<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/uploads/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/uploads/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"cybermind.fr","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.10.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

  <meta name="description" content="&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Permissions Fault after privilege’s escalation &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;A “By Design” Reproductible Integrity Vulnerability.Discovered on the 2th of mar">
<meta property="og:type" content="article">
<meta property="og:title" content="Microsoft  - Windows 7  - Permissions Fault after privilege&#39;s escalation">
<meta property="og:url" content="https://cybermind.fr/en/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/">
<meta property="og:site_name" content="CyberMind.FR">
<meta property="og:description" content="&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Permissions Fault after privilege’s escalation &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;A “By Design” Reproductible Integrity Vulnerability.Discovered on the 2th of mar">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2012-03-01T23:00:00.000Z">
<meta property="article:modified_time" content="2022-03-26T10:28:05.068Z">
<meta property="article:author" content="CyberMind">
<meta property="article:tag" content="cybersecurity">
<meta property="article:tag" content="vulnerability">
<meta property="article:tag" content="by-design">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://cybermind.fr/en/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cybermind.fr/en/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/","path":"en/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/","title":"Microsoft  - Windows 7  - Permissions Fault after privilege's escalation"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Microsoft  - Windows 7  - Permissions Fault after privilege's escalation | CyberMind.FR</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">
      <img class="custom-logo-image" src="/uploads/images/custom-logo.jpg" alt="CyberMind.FR">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">CyberMind.FR</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Embedded Developer / CyberSecurity Consultant @CyberMindFR</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        
      
        
      
        
      
        <li class="menu-item menu-item-support"><a href="/legal/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Support</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="CyberMind"
      src="/uploads/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">CyberMind</p>
  <div class="site-description" itemprop="description">Mon activité principale est le développement sur mesure de logiciels libres et de solutions dans le domaine de la cybersécurité.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CyberMind-FR" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CyberMind-FR" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/CyberMindFR" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;CyberMindFR" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.youtube.com/channel/UCDSECcnxHuJeHPJSLHvBzbQ/about" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCDSECcnxHuJeHPJSLHvBzbQ&#x2F;about" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/company/Cybermindfr" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;company&#x2F;Cybermindfr" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:info@cybermind.fr?subject=contact" title="E-Mail → mailto:info@cybermind.fr?subject&#x3D;contact"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.fr" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://connect.ed-diamond.com/auteur/kerma-gerald" title="https:&#x2F;&#x2F;connect.ed-diamond.com&#x2F;auteur&#x2F;kerma-gerald" rel="noopener" target="_blank">Editions Diamond</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.francenum.gouv.fr/trouver-un-accompagnement/cybermindfr" title="https:&#x2F;&#x2F;www.francenum.gouv.fr&#x2F;trouver-un-accompagnement&#x2F;cybermindfr" rel="noopener" target="_blank">France Num (Gouv.fr)</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cybermalveillance.gouv.fr/resultat-recherche-prestataire?search=cybermind" title="https:&#x2F;&#x2F;www.cybermalveillance.gouv.fr&#x2F;resultat-recherche-prestataire?search&#x3D;cybermind" rel="noopener" target="_blank">CyberMalveillance (Gouv.fr)</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://cybermind.fr/en/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/images/avatar.jpg">
      <meta itemprop="name" content="CyberMind">
      <meta itemprop="description" content="Mon activité principale est le développement sur mesure de logiciels libres et de solutions dans le domaine de la cybersécurité.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CyberMind.FR">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Microsoft  - Windows 7  - Permissions Fault after privilege's escalation
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2012-03-02 00:00:00" itemprop="dateCreated datePublished" datetime="2012-03-02T00:00:00+01:00">2012-03-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-03-26 11:28:05" itemprop="dateModified" datetime="2022-03-26T11:28:05+01:00">2022-03-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Permissions Fault after privilege’s escalation &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>A “By Design” Reproductible Integrity Vulnerability.<br>Discovered on the 2th of march 2012.</p>
<p><del><a href="mailto:&#115;&#101;&#99;&#x75;&#114;&#101;&#64;&#x6d;&#105;&#x63;&#114;&#111;&#x73;&#111;&#102;&#116;&#46;&#99;&#x6f;&#109;">&#115;&#101;&#99;&#x75;&#114;&#101;&#64;&#x6d;&#105;&#x63;&#114;&#111;&#x73;&#111;&#102;&#116;&#46;&#99;&#x6f;&#109;</a></del></p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Type of issue (buffer overflow, SQL injection, cross-site scripting, etc.) &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>Permissions Fault after privilege’s escalation</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Product and version that contains the bug &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>Windows 7 Entreprise x86</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Service packs, security updates, or other updates for the product you have installed &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>Full updated on the 2012&#x2F;02&#x2F;04</p>
<ul>
<li>Full (101) updates</li>
<li>French Language Pack</li>
<li>No browser choice made (closed)</li>
<li>No IE 9 (ask later)</li>
</ul>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Any special configuration required to reproduce the issue &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>Standard Windows 7 install with User(s) and administrator</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Step-by-step instructions to reproduce the issue on a fresh install &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<ul>
<li>Installation<ul>
<li>Fresh default install from en_windows_7_enterprise_x86_dvd_x15</li>
<li>Full update 101 Updates</li>
<li>No browser choice made</li>
<li>No IE 9 (ask later)</li>
</ul>
</li>
<li>Prepare environment<ul>
<li>Login adminstrator’s user</li>
<li>Create Standard Account User0</li>
<li>Create Standard Account User1</li>
<li>Login User0</li>
<li>Loggoff User0</li>
<li>Login User1</li>
<li>Logoff User1</li>
<li>Reboot</li>
</ul>
</li>
<li>Reproducing issue<ul>
<li>Login User0</li>
<li>Try to access User1’s private folder in profile folder (c:\users\user1\Documents)</li>
<li>UAC escalation (administrator’s password needed)</li>
<li>folder’s permissions for User0 have been added (full control) on the accessed folder (c:\users\user1\Documents)</li>
</ul>
</li>
<li>Proof of the issue<ul>
<li>Reboot</li>
<li>Login User0</li>
<li>try to acces User1’s folder (c:\users\user1\Documents)</li>
<li>-&gt; NO more UAC needed</li>
<li>create folder “Corrupted Permissions” in (c:\users\user1\Documents)</li>
</ul>
</li>
</ul>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Proof-of-concept or exploit code &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>Screenshots needed ? ;-)</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Impact of the issue, including how an attacker could exploit the issue &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>After an administrator account has made UAC’s ecalation of privileges to acces on a User1 folder while User0 logged, User0 will have a full access of the User1 folder accessed without the need of UAC’s escalation.<br>May affect integrity of Users’ files by another user(s).</p>
<p>May be some other side effects…</p>
<hr>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; MSRC Mail Exchange &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<pre><code>Le 06/02/2012 18:20, Microsoft Security Response Center a écrit
</code></pre>
<p>Hello xxxxxx,</p>
<p>Thank you for reporting this behavior to us.  I was able to reproduce this behavior and can confirm that this is by design behavior to allow user0 access to user1’s content.  As the repro requires administrative credentials,  this does not hit the security bug bar due to the fact that this behavior is by design as the user is prompted as expected for administrative credentials.  Oonce someone has those credentials they can take any action that an administrator can including adding themselves as an administrator or adding themselves to any folder they wish.  </p>
<p>Best Regards,<br>xxxx</p>
<pre><code>Tuesday, February 14, 2012 7:44 AM
</code></pre>
<p>To: Microsoft Security Response Center<br>Subject: Re: Microsoft Security :: Coordinated Vulnerability Disclosure | Report a Vulnerability | MSRC</p>
<p>Hello xxxx,</p>
<p>I need a clarification, in the following step (I put the original message at bottom) :</p>
<ul>
<li>folder’s permissions for User0 have been added (full control) on the accessed folder (c:\users\user1\Documents)</li>
</ul>
<p>You agree that it was done by UAC, in a transparent and persistent way.  With no other action than UAC privilege escalation.</p>
<p>It’s a data user integrity issue than can cause another side effects as data disclosure…</p>
<p>Regards,</p>
<pre><code>14/02/2012 19:38 from Microsoft Security Response Center ====
</code></pre>
<p>Hello xxxxxx,</p>
<p>Thank you for your message.  The action occurring here is providing access for user0 to user1’s folder by providing administrative credentials.  This is not a vulnerability and is not a privilege escalation.  When you grant user0 access to user1’s data, administrative credentials are required.  <strong>When the administrator grants this access, it is permanent</strong>.  This is the reason user0 can access user1’s data.</p>
<p>Best Regards,<br>xxxx</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/paypal.png" alt="CyberMind PayPal">
        <span>PayPal</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>CyberMind
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://cybermind.fr/en/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/" title="Microsoft  - Windows 7  - Permissions Fault after privilege&#39;s escalation">https://cybermind.fr/en/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.fr" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://twitter.com/CyberMindFR">
          <span class="icon">
            <i class="fab fa-twitter"></i>
          </span>

          <span class="label">Twitter</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/cybersecurity/" rel="tag"># cybersecurity</a>
              <a href="/tags/vulnerability/" rel="tag"># vulnerability</a>
              <a href="/tags/by-design/" rel="tag"># by-design</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/en/2011/11/09/DouDouLinux-Development-contribs/" rel="prev" title="DouDouLinux - Development contribs">
                  <i class="fa fa-chevron-left"></i> DouDouLinux - Development contribs
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/fr/2014/09/24/HowTo-Hack-a-NAS-CLOUD/" rel="next" title="HowTo Hack a NAS CLOUD">
                  HowTo Hack a NAS CLOUD <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>English</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="" aria-label="Select language">
      
        <option value="en" data-href="/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/" selected="">
          English
        </option>
      
        <option value="fr" data-href="/fr/2012/03/02/Microsoft-Windows-7-Permissions-Fault-after-privilege-s-escalation/" selected="">
          Français
        </option>
      
    </select>
  </div>


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CyberMind</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
